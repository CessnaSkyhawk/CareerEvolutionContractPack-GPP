// *************************** Moon Orbital Scan

CONTRACT_TYPE
{
	name = BaseMoonScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 98
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Moon
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The moon has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The moon has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = SSOneYear
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MoonSat
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseMoonScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Moon Base Rover

CONTRACT_TYPE
{
	name = BaseMoonScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 98
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Moon
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The moon has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The moon has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = SSOneYear
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MoonSat
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = MoonRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnMoon
			type = ReachState
			targetBody = HomeWorld().Children().First()
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Moon Base Core

CONTRACT_TYPE
{
	name = BaseMoonCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 98
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Moon
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MoonLandingStay
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = CONTRACT_ACTIVE
		targetRover = [ MoonRover ].Where(v => v.IsLanded()).Random()
		title = Get the Moon Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Moon Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = MoonBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			targetBody = HomeWorld().Children().First()
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseMoonCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = MoonBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnMoon
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Moon Base Crew

CONTRACT_TYPE
{
	name = BaseMoonCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 98
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Moon
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ MoonBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).Random()
		title = Get the Moon Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Moon Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseMoonCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Minmus Orbital Scan

CONTRACT_TYPE
{
	name = BaseMinmusScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 99
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = We have built a base on @CareerEvolution:Moon and now we want to expand with a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Minmus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT
	{
		name = TwoMoons
		type = Expression
		expression = HomeWorld().Children().Count() > 1
		title = The Home World must have 2 moons
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The moon has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The moon has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MinmusSat
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseMinmusScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Minmus Base Rover

CONTRACT_TYPE
{
	name = BaseMinmusScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 99
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Minmus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT
	{
		name = TwoMoons
		type = Expression
		expression = HomeWorld().Children().Count() > 1
		title = The Home World must have 2 moons
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The moon has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The moon has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MinmusSat
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMinmusRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = MinmusRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnMoon
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Minmus Base Core

CONTRACT_TYPE
{
	name = BaseMinmusCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 99
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Minmus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = TwoMoons
		type = Expression
		expression = HomeWorld().Children().Count() > 1
		title = The Home World must have 2 moons
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMinmusScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = MinmusLandingStay
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ MinmusRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Minmus Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the moon Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = MoonBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseMoonCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = MinmusBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnMoon
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Minmus Base Crew

CONTRACT_TYPE
{
	name = BaseMinmusCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 99
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = @CareerEvolution:Minmus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = TwoMoons
		type = Expression
		expression = HomeWorld().Children().Count() > 1
		title = The Home World must have 2 moons
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMinmusCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ MinmusBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Moon Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Moon Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseMoonCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Niven Orbital Scan

CONTRACT_TYPE
{
	name = BaseNivenScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Niven
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = NivenLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseNivenScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseNivenScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Niven Base Rover

CONTRACT_TYPE
{
	name = BaseNivenScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Niven
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = NivenLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnNiven
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Niven Base Core

CONTRACT_TYPE
{
	name = BaseNivenCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Niven
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseNivenScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = NivenLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ NivenRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Niven Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Niven Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = NivenBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseNivenCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = NivenBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Niven Base Crew

CONTRACT_TYPE
{
	name = BaseNivenCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Niven
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseNivenCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ NivenBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Niven Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Niven Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseNivenCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Laythe Orbital Scan

CONTRACT_TYPE
{
	name = BaseLaytheScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Laythe
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = TellumoMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseLaytheScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseLaytheScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Laythe Base Rover

CONTRACT_TYPE
{
	name = BaseLaytheScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Laythe
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanLaytheltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = TellumoMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnLaythe
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Laythe Base Core

CONTRACT_TYPE
{
	name = BaseLaytheCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Laythe
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseLaytheScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = LaytheLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ LaytheRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Laythe Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Laythe Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = LaytheBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseLaytheCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = LaytheBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Laythe Base Crew

CONTRACT_TYPE
{
	name = BaseLaytheCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Laythe
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseLaytheCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ LaytheBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Laythe Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Laythe Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseLaytheCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Tellumo Orbital Scan

CONTRACT_TYPE
{
	name = BaseTellumoScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tellumo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = TellumoLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseTellumoScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseTellumoScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Tellumo Base Rover

CONTRACT_TYPE
{
	name = BaseTellumoScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tellumo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = TellumoLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnTellumo
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Tellumo Base Core

CONTRACT_TYPE
{
	name = BaseTellumoCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tellumo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseTellumoScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = TellumoLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ TellumoRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Tellumo Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Tellumo Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = TellumoBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseTellumoCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = TellumoBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Tellumo Base Crew

CONTRACT_TYPE
{
	name = BaseTellumoCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tellumo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseTellumoCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ TellumoBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Tellumo Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Tellumo Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseTellumoCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Gratian Orbital Scan

CONTRACT_TYPE
{
	name = BaseGratianScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Gratian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GratianLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseGratianScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseGratianScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Gratian Base Rover

CONTRACT_TYPE
{
	name = BaseGratianScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Gratian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GratianLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnGratian
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Gratian Base Core

CONTRACT_TYPE
{
	name = BaseGratianCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Gratian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseGratianScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GratianLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ GratianRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Gratian Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Gratian Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = GratianBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseGratianCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = GratianBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Gratian Base Crew

CONTRACT_TYPE
{
	name = BaseGratianCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Gratian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseGratianCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ GratianBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Gratian Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Gratian Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseGratianCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Augustus Orbital Scan

CONTRACT_TYPE
{
	name = BaseAugustusScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Augustus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = OthoMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseAugustusScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseAugustusScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Augustus Base Rover

CONTRACT_TYPE
{
	name = BaseAugustusScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Augustus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = OthoMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnAugustus
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Augustus Base Core

CONTRACT_TYPE
{
	name = BaseAugustusCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Augustus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseAugustusScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = OthoMoonsLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ AugustusRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Augustus Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Augustus Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = AugustusBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseAugustusCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = AugustusBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Augustus Base Crew

CONTRACT_TYPE
{
	name = BaseAugustusCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Augustus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseAugustusCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ AugustusBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Augustus Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Augustus Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseAugustusCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Tarsiss Orbital Scan

CONTRACT_TYPE
{
	name = BaseTarsissScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tarsiss
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GaussMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseTarsissScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseTarsissScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Tarsiss Base Rover

CONTRACT_TYPE
{
	name = BaseTarsissScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tarsiss
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GaussMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnTarsiss
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Tarsiss Base Core

CONTRACT_TYPE
{
	name = BaseTarsissCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tarsiss
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseTarsissScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = GaussMoonsLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ TarsissRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Tarsiss Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Tarsiss Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = TarsissBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseTarsissCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = TarsissBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Tarsiss Base Crew

CONTRACT_TYPE
{
	name = BaseTarsissCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Tarsiss
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseTarsissCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ TarsissBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Tarsiss Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Tarsiss Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseTarsissCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Hadrian Orbital Scan

CONTRACT_TYPE
{
	name = BaseHadrianScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Hadrian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = NeroMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseHadrianScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseHadrianScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Hadrian Base Rover

CONTRACT_TYPE
{
	name = BaseHadrianScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Hadrian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = NeroMoonsLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnHadrian
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Hadrian Base Core

CONTRACT_TYPE
{
	name = BaseHadrianCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Hadrian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseHadrianScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = NeroMoonsLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ HadrianRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Hadrian Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Hadrian Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = HadrianBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseHadrianCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = HadrianBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Hadrian Base Crew

CONTRACT_TYPE
{
	name = BaseHadrianCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Hadrian
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseHadrianCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ HadrianBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Hadrian Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Hadrian Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseHadrianCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Argo Orbital Scan

CONTRACT_TYPE
{
	name = BaseArgoScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Argo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = HoxMoonLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseArgoScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseArgoScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Argo Base Rover

CONTRACT_TYPE
{
	name = BaseArgoScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Argo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = HoxMoonLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnArgo
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Argo Base Core

CONTRACT_TYPE
{
	name = BaseArgoCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Argo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseArgoScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = HoxMoonLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ ArgoRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Argo Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Argo Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = ArgoBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseArgoCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = ArgoBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Argo Base Crew

CONTRACT_TYPE
{
	name = BaseArgoCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Argo
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseArgoCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ ArgoBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Argo Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Argo Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseArgoCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Leto Orbital Scan

CONTRACT_TYPE
{
	name = BaseLetoScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Leto
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = LetoLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseLetoScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseLetoScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Leto Base Rover

CONTRACT_TYPE
{
	name = BaseLetoScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Leto
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = LetoLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnLeto
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Leto Base Core

CONTRACT_TYPE
{
	name = BaseLetoCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Leto
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseLetoScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = LetoLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ LetoRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Leto Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Leto Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = LetoBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseLetoCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = LetoBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Leto Base Crew

CONTRACT_TYPE
{
	name = BaseLetoCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Leto
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseLetoCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ LetoBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Leto Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Leto Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseLetoCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Eta Orbital Scan

CONTRACT_TYPE
{
	name = BaseEtaScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Eta
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = ThaliaMoonLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseEtaScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseEtaScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Eta Base Rover

CONTRACT_TYPE
{
	name = BaseEtaScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Eta
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanetAltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = ThaliaMoonLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnEta
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Eta Base Core

CONTRACT_TYPE
{
	name = BaseEtaCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Eta
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseEtaScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = ThaliaMoonLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ EtaRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Eta Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Eta Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = EtaBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseEtaCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = EtaBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Eta Base Crew

CONTRACT_TYPE
{
	name = BaseEtaCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Eta
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseEtaCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ EtaBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Eta Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Eta Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseEtaCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}

// *************************** Icarus Orbital Scan

CONTRACT_TYPE
{
	name = BaseIcarusScan
    group = SurfaceBases
	
    title = Orbital Scan of @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Scan @targetBody for a suitable base location
	notes = Scan @targetBody for a suitable base location
	
    description = The next step in our expanse into space is the establishment of a base on @targetBody. In order to make sure we put the base in the best location, we should scan the surface for topography and resource distribution.
	
    completedMessage = Congratulations! The data returned by our orbital scanners will give us the best locations to focus our search.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Icarus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks	
    advanceFunds = @CareerEvolution:Kerbucks
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = MoonOrbitalSurvey
		type = PerformOrbitalSurvey
		invertRequirement = true
		title = The planet has not had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = MoonAltimetryHiRes
		type = SCANsatCoverage
		maxCoverage = 80.0
		scanType = AltimetryHiRes
		title = The planet has not had a High Res Scan
	}
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = OrbitalScannerUnlocked
		type = PartModuleUnlocked
		partModule = ModuleOrbitalSurveyor
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = HiResScannerUnlocked
		type = PartUnlocked
		part = SCANsat_Scanner2
		title = Must have an orbital scanner unlocked
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCore
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = IcarusLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseIcarusScan
		type = VesselParameterGroup
		title = Scan @targetBody
		define = BaseIcarusScan
		
		PARAMETER:NEEDS[!SCANsat]
		{
			name = PerformOrbitalSurvey
			type = PerformOrbitalSurvey
			title = Perform an Orbital Survey
			hideChildren = true
		}
		
		PARAMETER:NEEDS[SCANsat]
		{
			name = HiResCoverage
			type = SCANsatCoverage
			coverage = 85.0
			scanType = AltimetryHiRes
		}
	}
}

// *************************** Icarus Base Rover

CONTRACT_TYPE
{
	name = BaseIcarusScout
    group = SurfaceBases
	
    title = Use a Rover to Scout @targetBody for a Base Location
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Use a Rover to Scout @targetBody for a Base Location
	notes = Use a Rover to Scout @targetBody for a Base Location
	
    description = We have orbital information about the resources on @targetBody, but now we need to refine our search using a rover. Once you find a suitable location, park your rover there and be sure to set the ship type to Rover. This will be the location that is the target for your future base.
	
    completedMessage = Congratulations! You have chosen the spot of your base. The next step is to start building it!
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Icarus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Trivial
	
	REQUIREMENT:NEEDS[!SCANsat]
	{
		name = PlanetOrbitalSurvey
		type = PerformOrbitalSurvey
		title = The planet has had an orbital survey
	}
	
	REQUIREMENT:NEEDS[SCANsat]
	{
		name = PlanIcarusltimetryHiRes
		type = SCANsatCoverage
		minCoverage = 79.0
		scanType = AltimetryHiRes
		title = The planet has had a High Res Scan
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseMoonCrew
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = IcarusLanding
		title = Complete @contractType Contract
	}
	
	PARAMETER
	{
		name = BaseMoonRover
		type = VesselParameterGroup
		title = Find a suitable place for your base by using a rover
		notes = Once you find the site for your base, make sure you change the vessel type to Rover. This is where the next contract will generate your waypoint for the base building.
		defineList = DunaRover
		
		PARAMETER 
		{
			name = Crewmembers
			type = HasCrew
			minCrew = 0
			maxCrew = 0
			title = Uncrewed
			hideChildren = true
		}
		
		PARAMETER
		{
			name = LandOnIcarus
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
		}
		
		PARAMETER
		{
			name = VesselIsRover
			type = VesselIsType
			vesselType = Rover
			title = Change the vessel type to Rover
			hideChildren = true
		}
	}
	
	PARAMETER
	{
		name = ScoutingDuration
		type = Duration
		completeInSequence = true
		duration = 5m
		preWaitText = Searching for suitable site
		waitingText = Surveying Area
		completionText = This is the spot!
	}
}

// *************************** Icarus Base Core

CONTRACT_TYPE
{
	name = BaseIcarusCore
    group = SurfaceBases
	
    title = Create a Surface Base on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Create a new Surface Base on @targetBody near your Scout Rover
	notes = Create a new Surface Base on @targetBody near your Scout Rover
	
    description = You have scanned the surface for resources and have scouted with your rover to choose a location. Now it is time to build your base. You can launch everything at once, or you can build all of the requirements in multiple launches, the choice is yours.
	
    completedMessage = Congratulations! Your base is up and running! Do you have a crew? If not, I'm sure Mission Control will create a mission for you.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Icarus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks5
    advanceFunds = @CareerEvolution:Kerbucks5
	
	prestige = Exceptional
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseIcarusScout
		title = Complete @contractType Contract
	}
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = IcarusLanding-Crew
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetRover = [ IcarusRover ].Where(v => v.VesselType() == Rover && v.IsLanded() == true).SelectUnique()
		title = Get the Icarus Base Scout Rover
	}
	
	DATA
	{
		type = Location
		roverLocation = @/targetRover.Location()
		hidden = true
		title = Get the Icarus Base Scout Rover Location
	}
	
	BEHAVIOUR
	{
		name = IcarusBaseWaypoint
		type = WaypointGenerator
		WAYPOINT
		{
			name = Base Landing Spot
			icon = balloon
			altitude = 0.0
			latitude = @/roverLocation.Latitude()
			longitude = @/roverLocation.Longitude()
		}
	}
	
	PARAMETER
	{
		name = BaseIcarusCore
		type = VesselParameterGroup
		title = Build Your @targetBody Base!
		notes = The initial landing spot for your base will be where you left your scout rover. You can choose to fufill all the base requirements with one launch, or you can use multiple launches to get everything you need to create your base.
		defineList = IcarusBase
		
		PARAMETER
		{
			name = HasCapacity
			type = HasCrewCapacity
			minCapacity = 3
			title = Space for at least 3 crew
			hideChildren = true
			disableOnStateChange = true
		}
		
		// Have Power Generation
		PARAMETER
		{
			name = PowerGeneration
			type = Any
			title = Have any type of Power Generation on your Station
			disableOnStateChange = true
			
			PARAMETER
			{
				name = PartValidationSolar
				type = PartValidation
				partModule = ModuleDeployableSolarPanel
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
			PARAMETER
			{
				name = PartValidationRTG
				type = PartValidation
				partModule = ModuleGenerator
				minCount = 1
				title = Have at least 1 RTG
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureSolar]
			{
				name = PartValidationNFSolar
				type = PartValidation
				partModule = ModuleCurvedSolarPanel
				minCount = 1
				title = Have at least 1 Curved Solar Panel
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFFission
				type = PartValidation
				partModule = FissionReactor
				minCount = 1
				title = Have at least 1 Fisson Reactor
				hideChildren = true
			}
			PARAMETER:NEEDS[NearFutureElectrical]
			{
				name = PartValidationNFRTG
				type = PartValidation
				partModule = ModuleRadioisotopeGenerator
				minCount = 1
				title = Have at least 1 Solar Panel
				hideChildren = true
			}
		}
		// Have Science Lab
		PARAMETER
		{
			name = ScienceLab
			type = PartValidation
			title = Have at least one Science Lab on the station
			minCount = 1
			partModule = ModuleScienceLab
			hideChildren = true
			disableOnStateChange = true
		}
		
		PARAMETER
		{
			name = LandAtWaypoint
			type = VisitWaypoint
			index = 0
			distance = 2000.0
			title = Land near @targetBody Scout Rover
			showMessages = true
		}
		
		PARAMETER
		{
			name = LandOnPlanet
			type = ReachState
			situation = LANDED
			disableOnStateChange = true
			title = Land on @targetBody
			hideChildren = true
			hidden = true
		}
		
		PARAMETER
		{
			name = VesselIsBase
			type = VesselIsType
			vesselType = Base
			title = Change the vessel type to Base
			hideChildren = true
		}
	}
}

// *************************** Icarus Base Crew

CONTRACT_TYPE
{
	name = BaseIcarusCrew
    group = SurfaceBases
	
    title = Send a full crew to your Space Station on @targetBody
	agent = Experimental Engineering Group
	
	sortKey = 100
	
    synopsis = Send a full crew to your Space Station on @targetBody
	notes = Send a full crew to your Space Station on @targetBody
	
    description = Your base is up and running, and you might even have some crew there already, but we need you to make sure that you have a full crew. When your station is full, walk outside and Plant a Flag to stake your claim as @targetBody Station Expedition 1.
	
    completedMessage = Congratulations! Your base is running smoothly with your crew! You can continue to add to your base, run some routine maintenance missions, or you can start on bases elsewhere.
	
	minExpiry = 0
    maxExpiry = 0
    maxCompletions = 1
	
    cancellable = true
    declinable = true
	
    targetBody = Icarus
	
	// REWARDS
    rewardScience = 1
    rewardReputation = 1
    rewardFunds = @CareerEvolution:Kerbucks2
    advanceFunds = @CareerEvolution:Kerbucks2
	
	prestige = Significant
	
	REQUIREMENT
	{
		name = CompleteContract
		type = CompleteContract
		contractType = BaseIcarusCore
		title = Complete @contractType Contract
	}
	
	DATA
	{
		type = Vessel
		requiredValue = true
		hidden = true
		uniquenessCheck = GROUP_ALL
		targetBase = [ IcarusBase ].Where(v => v.VesselType() == Base && v.IsLanded() == true).SelectUnique()
		title = Get the Icarus Base
	}
	
	DATA
	{
		type = Location
		baseLocation = @/targetBase.Location()
		hidden = true
		title = Get the Icarus Base Location
	}
	
	DATA
	{
		type = int
		requiredValue = true
		baseCrewCapacity = @/targetBase.CrewCapacity()
		title = What is the capacity of the base?
	}
	
	PARAMETER
	{
		name = BaseIcarusCrew
		type = VesselParameterGroup
		title = Fill your station with Crew
		notes = If your station is already filled, just EVA a Kerbal to Plant a Flag for Expedition 1.
		vessel = @/targetBase
		
		PARAMETER
		{
			name = FullCrew
			type = HasCrew
			minCrew = @/baseCrewCapacity
			title = Have a full crew of @minCrew
			hideChildren = true
			disableOnStateChange = true
		}
	}
	
	PARAMETER
	{
		name = FlagExpedition1
		type = PlantFlag
		title = Plant a flag for Expedition 1
		hideChildren = true
	}
}